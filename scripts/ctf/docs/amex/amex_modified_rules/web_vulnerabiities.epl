/*
AEXP Web Vulnerabilities
*/

module WebVulnerabilities;

@Name('Module_WebVulnerabilities')
@RSAAlert(identifiers={"ip_src"})

SELECT window(*) FROM Event(ec_activity = 'Logon' AND ec_outcome = 'Failure').std:groupwin(ip_src).std:unique(msg_id).win:time_length_batch(5 sec, 2) GROUP BY ip_src HAVING count(*) = 2 OUTPUT first every 10 minutes;

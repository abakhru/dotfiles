/*
AEXP Potential Cross Site Scripting
*/

module PotentialCrossSiteScripting;

@Name('Module_PotentialCrossSiteScripting')
@RSAAlert(identifiers={"ip_src"})

SELECT window(*) FROM Event ( ec_activity = 'Logon' AND (ec_outcome LIKE '%uccess%' OR ec_outcome LIKE '%ailure%')).std:groupwin(ip_src).std:unique(ec_outcome).win:time_length_batch(60 sec, 1) GROUP BY ip_src HAVING count(*) = 1 OUTPUT first every 10 minutes;

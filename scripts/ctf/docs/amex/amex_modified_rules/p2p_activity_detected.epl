/*
AEXP P2P Activity Detected
*/

module P2PActivityDetected;

@Name('Module_P2PActivityDetected')
@RSAAlert(identifiers={"ip_src"})

SELECT window(*) FROM Event (ec_activity = 'Logon' AND ec_outcome LIKE '%ailure%' AND ip_src IS NOT NULL).std:groupwin(ip_src).std:unique(ec_outcome).win:time_length_batch(600 sec, 2) GROUP BY ip_src HAVING count(*) = 2 OUTPUT first every 10 minutes;

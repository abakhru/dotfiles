/*
AEXP HTTP Vulnerability Scan - Generic
*/

module HTTPVulnerabilityScanGeneric;

@Name('Module_HTTPVulnerabilityScanGeneric')
@RSAAlert(identifiers={"ip_src"})

SELECT window(*) FROM
Event (
device_type = 'intrushield' AND
msg_id IN ('0x40200b00:01' , '0x40201100:01' , '0x40201500:01' , '0x40201800:01' , '0x40201c00:01' , '0x40201e00:01' , '0x40202000:01' , '0x40202500:01' , '0x40202700:01' , '0x40202c00:01' , '0x40203200:01' , '0x40203a00:01' , '0x40204200:01' , '0x40204400:01' , '0x40204a00:01' , '0x40204b00:01' , '0x40205a00:01' , '0x40206300:01' , '0x40207300:01' , '0x40207600:01' , '0x40207700:01' , '0x40207800:01' , '0x40207c00:01' , '0x40207e00:01' , '0x40208400:01' , '0x40208800:01' , '0x40209700:01' , '0x4020a600:01' , '0x4020a900:01' , '0x4020ac00:01' , '0x4020b300:01' , '0x4020b700:01' , '0x4020b900:01' , '0x4020be00:01' , '0x4020c600:01' , '0x4020d000:01' , '0x4020d700:01' , '0x4020ef00:01' , '0x4020f700:01' , '0x4020f900:01' , '0x4020fe00:01' , '0x4020ff00:01' , '0x40210800:01' , '0x40212e00:01' , '0x40215000:01' , '0x40215400:01' , '0x40215f00:01' , '0x40216800:01' , '0x40216a00:01' , '0x40216d00:01' , '0x40219700:01' , '0x40221e00:01' , '0x4027b000:01')
).std:groupwin(ip_src)
		.std:unique(msg_id)
		.win:time_length_batch(900 sec, 3)
		 GROUP BY ip_src HAVING count(*) = 3
OUTPUT first every 10 minutes;
